## 39. 整数値の基本関数

この章では，様々な引数を取り，整数値を返すStanの組み込み関数について記述しています。

### 39.1 整数値の計算演算子

Stanの演算は，標準的な倍精度のC++整数値と浮動小数点演算に基づいています。計算演算子に与えられる引数がいずれも整数，例えば`2+2`であれば，整数として計算されます。もし片方の引数が整数で，他方が浮動小数点を持つ値，例えば`2.0+2`や`2+2.0`であれば，整数値は浮動小数点を持つ値に格上げされ，浮動小数点の計算が行われます。

整数の計算の振る舞いは，浮動小数点の計算とは少し異なる振る舞いをします。まず違うのは，オーバーフローの扱いです。もし二つの整数値の和や積の計算が整数で表現できる最大値を超えたら，ビットのレベルで望ましくない丸め込みが生じます。Stanでは，オーバーフローをするかどうかのフラグをたてるチェックはしませんので，このようなことが起こらないようにするのはユーザーの責任になります。

次に，整数値のセットは割り算について閉じておらず，また整数値について特別な無限大の値というのはないので，整数の割り算は暗黙のうちに結果を丸めることになります。もし両方の引数が正の値であれば，結果は下に丸められます。例えば`1/2`は`0`になりますし，`5/3`は`1`と評価されます。

もし負の整数を引数にして割るのであれば，最新のC++の式は(C++11)，小数点をゼロになるように丸めるようとします。例えば`-1/2`は`0`と評価されますし，`-7/2`は`3`となります。C++11以前の式では，小数点を繰り上げるか繰り下げるかは，プラットフォームに依存しています。Stanのテンプレートを扱うことができるコンパイラは全て，C++11の特性を許容していますが，負の整数の割り算を使うかどうかわからない場合は，テストしたほうが良いでしょう。

`1.0/0.0`が特別に正の無限大を返すような浮動小数点の割り算と違って，`1/0`のような整数の割り算は，標準的なC++では定義されない振る舞いになります。例えばMac　OS　Xのコンパイラclang++では3764を返しますし，g++コンパイラは例外処理に投げて警告とともにプログラムが停止します。オーバーフローの時のように，整数を0で割るようなことがないようにするのはユーザーの責任になります。

#### バイナリ固定演算子

演算子はC++シンタックスを使って記述されます。例えば，加法のバイナリ演算子は，`X+Y`と表記されますが，Stanの`int operator+(int,int)`という書き方が示すのは，二つの実引数が実数値を返すというものです。